<!DOCTYPE html>
<html lang="en">

<head>
    <!-- scroll video -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- <link rel="stylesheet" href="../Game/styles.css"> -->
  
    <!-- Load GSAP scroll trigger -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.5/ScrollTrigger.min.js"></script>

    <!--  -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>A Guide to Proper Etiquette in the Men's Restrooms</title>

    <!-- Game CSS -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Brush+Script&family=Dokdo&family=Reenie+Beanie&display=swap');

        /* Game content wrapper - controls game element sizes */
        .game-content {
            width: 60vw;           /* â† CHANGE THIS to resize game elements */
            max-width: 1000px;     /* Max size cap */
            margin: 0 auto;
            
           
        }

        .containerGame {
            width: 100%;           /* Fill parent */
            display: flex;
            justify-content: center;
            align-items: flex-end; /* Align to bottom so person sits on urinal */
            gap: 3%;               /* Bigger gap between urinals */
            margin: 0 auto;
        }

        .containes {
            width: 100%;           /* Fill parent */
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 20px auto;
        }

        .occupied {
            position: absolute;
            bottom: 0%;           /* Lift person up slightly (responsive) */
            left: 50%;
            width: 150%;           /* 130% of urinal width */
            height: auto;
            transform: translateX(-50%); /* Center horizontally */
            object-fit: contain;
            z-index: 1;
        }

        .free {
            box-shadow: 0px 3px 3px rgba(0, 0, 0, 0.3);
            background: #f9f9f9;
            border: 1px solid rgba(0, 0, 0, 0.0);
            width: 100%;           /* Fill section */
        }

        .free:hover {
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
        }

        .game-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.536);
        }

        .game-modal-content {
            font-family: Dokdo;
            font-size: 2rem;
            color: #f4f4f4;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 10px;
        }

        #restart, #playagain {
            /* border: #000 solid 4px; */
            font-family: Dokdo;
            font-size: 2rem;
            color: #000;
            background-color: #f9f9f9;
            cursor: pointer;
            padding: 5px 10px;
            box-shadow: 0px 3px 3px rgba(0, 0, 0, 0.3);
        }

        #restart:hover, #playagain:hover {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
        }

        #restart:active, #playagain:active {
            transform: scale(0.9);
        }

        #giveup, #continue {
            /* border: #000 solid 4px; */
            font-family: Dokdo;
            font-size: 1.5rem;
            color: #000;
            background-color: #f9f9f9;
            cursor: pointer;
            padding: 5px 10px;
            box-shadow: 0px 3px 3px rgba(0, 0, 0, 0.3);
        }

        #giveup:hover, #continue:hover {
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
        }

        #giveup:active, #continue:active {
            transform: scale(0.9);
        }

        /* Cursor pointer for all clickable elements */
        button, .section:hover, .show {
            cursor: pointer;
        }

        /* Hover scale effect for all buttons */
        button:hover, .show:hover {
            transform: scale(1.05);
            transition: transform 0.2s ease;
        }

        /* Hover scale effect for urinals in game */
        .section {
            transition: transform 0.2s ease;
        }

        .section:hover {
            transform: scale(1.08);
        }

        /* Disable dragging for all elements */
        * {
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
            user-drag: none;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .section {
            flex: 1 1 18%;
            max-width: 170px;  /* Maximum width for each urinal */
            height: 100%;
            margin: 0 5px;
            position: relative;
            overflow: visible;
        }

        .countdown {
            font-size: 48px;
            text-align: center;
            margin: 20px 0;
            color: white;
        }

        @keyframes fadeOutClip {
            0% {
                clip-path: inset(0 0 0 0);
            }
            100% {
                clip-path: inset(0 100% 0 0);
            }
        }

        #mySvg {
            animation: fadeOutClip forwards;
            width: 30%;
            height: auto;
            clip-path: inset(0 0 0 0);
            position: relative;
            z-index: 10;
        }

        /* Mobile warning screen */
        .mobile-warning {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #fff;
            color: #000;
            z-index: 9999;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
        }

        .mobile-warning h1 {
            font-size: 4rem;
            margin: 0;
            transform: scaleX(1);
            letter-spacing: 0;
            direction: ltr;
        }

        /* Loader screen */
        .loader-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #000;
            z-index: 99999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .loader-spinner {
            width: 60px;
            height: 60px;
            border: 6px solid #333;
            border-top: 6px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loader-text {
            color: #fff;
            font-size: 2rem;
            font-family: Dokdo;
        }

        body.loading {
            overflow: hidden;
        }

        /* Show warning on small screens */
        @media screen and (max-width: 1024px) {
            .mobile-warning {
                display: flex !important;
            }
            body > *:not(.mobile-warning) {
                display: none !important;
            }
        }
    </style>
</head>

<body class="loading">

    <!-- Loader Screen -->
    <div class="loader-screen" id="loader">
        <div class="loader-spinner"></div>
        <div class="loader-text">Loading...</div>
    </div>

    <!-- Mobile Warning Screen -->
    <div class="mobile-warning">
        <h1>REAL gentlemen use NORMAL sized screens</h1>
    </div>




    <section class="top">
        <div class="row">

        </div>

    </section>
    <section class="first"> <!-- First page top -->
        <div class="row">
            <div class="col5">
                <img src="photos/wallDrawings/SVG/smile.svg" alt=""
                    style="top: 10px; right:0 ; width:20vw; position: absolute;">
            </div>
        </div>
        <div class="row" style="margin-top: 10%;">
            <div class="col7">
                <h2>A Guide to Proper Etiquette in the</h2>

            </div>
        </div>
        <div class="row">
            <div class="col10">
                <h1 style="line-height: 80%;">Men's Restrooms</h1>
            </div>
            <div class="row">
                <div class="col11">
                    <h2 style="text-align: right; transform: rotate(10deg);">Eyal Mordechai</h2>

                </div>
            </div>
            <div class="col5">
                <img src="photos/wallDrawings/SVG/face.svg" alt="" style="left:0 ; width:15vw; position: absolute;">
            </div>
        </div>


        <div class="row">

        </div>
    </section>

    <section class="second"> <!-- #1 heading do not have a convo -->
        <div class="row">
            <div class="col11">
                <h1>#1</h1>
            </div>
        </div>
        <div class="row">
            <div class="col11">
                <h2>do not have a conversation with ANYONE.</h2>
            </div>
            <div class="col5">
                <img src="photos/wallDrawings/SVG/Asset 1.svg" alt=""
                    style="right:15% ; height: 30vh; position: absolute;">
            </div>
            <div class="col5">
                <img src="photos/wallDrawings/SVG/money.svg" alt="" style=" left:0 ; height:35vh; position: absolute;">
            </div>
        </div>
    </section>

    <section class="third"> <!-- nod + nodding animal -->
        <div class="wrapper">
            <div class="row">
                <div class="col5">
                    <h2> A nod of acknowledgment is polite</h2>
                </div>
                <div class="col6"><img src="photos/nodding animal.gif" alt=""></div>
            </div>
            <div class="row">
                <img src="photos/wallDrawings/SVG/sole.svg" alt="" style=" left:-10% ; width:50vw; position: absolute;">

            </div>
            <div class="row">
                <img src="photos/wallDrawings/SVG/welfare.svg" alt=""
                    style=" transform: rotate(0deg); right:-0% ; width:20vw; position: absolute;">

            </div>
        </div>
        </div>
    </section>

    <section class="fourth" id="vidContainer"> <!-- never say more than hello + video -->
        <div class="wrapper">
            <div class="row" id="rowAbove">
                <div class="col5" style="padding-bottom: 0;">
                    <h2> NEVER say more than "Hello" or "Are you well?"</h2>
                </div>

                <div class="row" >
                    <div class="container" >
                        <video muted id="video" preload="auto" playsinline>
                            <source src="videos/chat.mp4" type='video/mp4' />
                        </video>
                    </div>

                </div>

            </div>
            <div class="row">
                <img src="photos/wallDrawings/SVG/amanda 2.svg" alt=""
                    style="transform: rotate(-25deg); left:5%; width:20vw; position: absolute;">
            </div>
        </div>
    </section>

    <section class="fifth" style="margin-top: 20vh;"> <!-- urinals title -->
        <div class="row">
            <div class="col11">
                <h1>#2</h1>
            </div>
        </div>
        <div class="row">
            <div class="col11">
                <h2>The urinals</h2>

            </div>
        </div>


        <div class="row mashtenas">
            <div class="col3 text-center"> <img src="photos/Asset 3.svg" alt="">

            </div>
            <div class="col3 text-center"> <img src="photos/Asset 2.svg" alt="">

            </div>
            <div class="col3 text-center"> <img src="photos/Asset 1.svg" alt="">
            </div>
        </div>
        <div class="row">
            <img src="photos/wallDrawings/SVG/sole 2.svg" alt=""
                style="right:10%; width:22vw; position: absolute;">
        </div>
    </section>
    <div class="row" style="margin-bottom: 20rem;">
        <div class="col11" style="position: relative;"><img src="photos/wallDrawings/SVG/thyme.svg" alt=""
                style=" transform: rotate(0deg); right:75% ; width:25vw; position: absolute;"></div>
    </div>
    <div class="row" style="margin-bottom: 30rem;">
        <div class="col11" style="position: relative;"><img src="photos/wallDrawings/SVG/troubles.svg" alt=""
                style=" transform: rotate(0deg); top:-20rem; right:-0% ; width:25vw; position: absolute;"></div>
    </div>
    <div class="row" style="margin-bottom: 20rem;">
        <div class="col11" style="position: relative;"><img src="photos/wallDrawings/SVG/money 2.svg" alt=""
                style="transform: rotate(15deg);  top:-20vh; left:5%; width:35vw; position: absolute;"></div>
    </div>

    <section class="sixth"> <!-- Urinals clean -->

        <div class="row">
            <div class="col7">
                <h2 class="text-center">Always leave at least one urinal open between you and the next person</h2>

            </div>

        </div>
        <div class="row">
        <div class="col12" style=" display: flex; justify-content: center;">
            <h2 style="margin: 0; margin-bottom: -4rem; right: 300px; transform: rotate(16.98deg); font-size: 3rem; font-family: Reenie Beanie; color: #FF3131;">
                not for use</h2>
        </div>
    </div>
        <div class="col12" style=" display: flex; justify-content: center; transform: rotate(-25deg)">
            <img src="photos/arrough.svg" alt="" style="width: 4rem; justify-content: center;">
        </div>
        <div class="row mashtenas">
            <div class="col3 text-center" style="position: relative;">
                <img src="photos/Asset 3.svg" alt="">
                <img src="photos/gifs/person1.gif" alt="" style="position: absolute; left: 20%; top: -5%; width: 67%;">

            </div>
            <div class="col3 text-center" style="position: relative;"> <img src="photos/Asset 2.svg" alt="">
                <img src="/photos/X.svg" alt="" style="position:absolute; left: 25px; bottom: 30%; width: 70%;">

            </div>
            <div class="col3 text-center"> <img src="photos/Asset 1.svg" alt="">
            </div>
        </div>
    </section>

    <div class="row" style="margin-bottom: 20rem;">
        <div class="col11" style="position: relative;"><img src="photos/wallDrawings/SVG/amanda.svg" alt=""
                style=" transform: rotate(35deg); left:0 ; width:20vw; position: absolute;"></div>
    </div>

    </div>

    <section class="preGame">
        <div class="row">
            <div class="col7">
                <h2 class="text-center">So... Where would you pee?</h2>
            </div>
        </div>
    </section>

    <!-- GAME -->
    <section class="game">

        <!-- Game Modals -->
        <div id="modalCorrect" class="game-modal">
            <div class="game-modal-content">
                <h1>Correct!</h1>
                <div id="countdown" class="countdown">Ready...</div>
            </div>
        </div>

        <div id="modalWrong" class="game-modal">
            <div class="game-modal-content">
                <h1>Wrong!</h1>
                <button id="restart" onclick="restartGame()">Restart</button>
                <button id="giveup" onclick="giveUpGame()">Give up</button>
            </div>
        </div>

        <div id="modalWin" class="game-modal">
            <div class="game-modal-content">
                <h1>You Win!</h1>
                <button id="restart" onclick="playAgain()">Play again</button>
                <button id="giveup" onclick="continueGame()">Continue</button>
            </div>
        </div>

        <!-- Game Content Wrapper -->
        <div class="game-content">
            <!-- Arrow -->
            <div class="containes">
                <img id="mySvg" src="game/Img/arrough.svg" alt="Arrow">
            </div>

            <!-- Urinals -->
            <div class="containerGame">
            <div id="urin1" class="section">
                <img src="game/Img/Asset 1.svg" alt="Photo 1">
                <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: block;">
            </div>
            <div id="urin2" class="section">
                <img src="game/Img/Asset 3.svg" alt="Photo 3">
                <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: none;">
            </div>
            <div id="urin3" class="section">
                <img src="game/Img/Asset 1.svg" alt="Photo 2">
                <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: block;">
            </div>
            <div id="urin4" class="section">
                <img src="game/Img/Asset 2.svg" alt="Photo 4">
                <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: none;">
            </div>
            <div id="urin5" class="section">
                <img src="game/Img/Asset 1.svg" alt="Photo 5">
                <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: none;">
            </div>
        </div>
        <!-- End urinals -->

        </div>
        <!-- End game-content wrapper -->

    </section>

    <section class="seventh"><!-- Urinals 1 person -->

        <div class="row">
            <div class="col7">
                <h2 class="text-center">if no free urinal exists between you and the other person</h2>
            </div>

        </div>

        <div class="row mashtenas">
            <div class="col3 text-center" style="position: relative;">
                <img src="photos/Asset 3.svg" alt="">
                <img src="photos/gifs/person1.gif" alt="" style="position: absolute; left: 20%; top: -5%; width: 67%;">

            </div>
            <div class="col3 text-center"> <img src="photos/Asset 2.svg" alt="">

            </div>
            <div class="col3 text-center" style="position: relative;">
                <img src="photos/Asset 1.svg" alt="">
                <img src="photos/gifs/person2.gif" alt="" style="position: absolute; left: 15%; top: -5%; width: 67%;">
            </div>
        </div>
        <div class="row">
            <img src="photos/wallDrawings/SVG/welfare 2.svg" alt=""
                style="transform: rotate(-20deg); right:8%; width:25vw; position: absolute;">
        </div>
    </section>

<!--  -->



    <section class="eighth" style="margin-top: 30vh;">


        </div>

        <div class="row">
            <div class="col7">
               
            </div>
        </div>

        <div class="row">
            <div class="col4" style="align-content: center; position: relative;">
                <img src="photos/Asla.svg" alt="" id="toilet">
                <img src="photos/natznatzimn.svg" alt="" id="sparklettes">
            </div>
        </div>

        <div class="row">
            <div class="col7">
                <h2 style="font-size: 6rem; text-align: center; margin-top: 3rem;">use a toilet</h2>

            </div>
    </section>

    <div class="row" style="margin-bottom: 15rem;">
        <div class="col11" style="position: relative;"><img src="photos/wallDrawings/SVG/thyme 2.svg" alt=""
                style="transform: rotate(10deg); left:0%; width:40vw; position: absolute;"></div>
    </div>

    <section class="second" style="margin-top: 20vh;"> <!-- urinals title -->
        <div class="row">
            <div class="col5" style="margin: 0;">
                <h1>#4</h1>
            </div>
            <div class="col10" style="margin: 0;">
                <h2>Watch where you look</h2>

            </div>
        </div>

    </section>

    <div class="row" style="margin-bottom: 15rem;">
        <div class="col11" style="position: relative;"><img src="photos/wallDrawings/SVG/troubles 2.svg" alt=""
                style="transform: rotate(-15deg); right:5%; width:24vw; position: absolute;"></div>
    </div>

    <!-- EYE MOVEMENT START -->

    <section class="eyettes" style="position: re;"> <!-- EYEBALLS -->
        <div class="row">
            <div class="col12" style="text-align: center;">
                <button class="show">
                    <h2 id="lUp">look up</h2>
                </button>
            </div>
        </div>
        <div class="row" style="justify-content: space-between; align-items: center;">


            <div class="mask" role="dialog"></div>
            <div class="modal" role="alert">
                <p>FUCK THEE</p>

            </div>
            <div class="col2">
                <button class="show">
                    <h2 id="lLeft">look left</h2>
                </button>
            </div>

            <div class="col7" style="position: relative;">
                <button class="show" id="wall" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: white; border: #000 solid 4px; display: none; padding: 40px 20px; z-index: 49;">
                    <h2 style="text-align: center; margin: 0;">Look straight</h2>
                </button>

                <main>
                    <img src="photos/socket.svg" id="anchor">
                    <div class="eyes">
                        <img src="photos/pupil.svg" class="eye" style="top: 38%;
                        left: 16%;">
                        <img src="photos/pupil2.svg" class="eye" style=" top: 38%;
                        left: 75%;">
                    </div>
            </div>
            <div class="col2">

                <button class="show">
                    <h2 id="lRight">look right</h2>
                </button>
            </div>
            </main>
        </div>
        <div class="row">
            <div class="col12" style="text-align: center;">
                <button class="show">
                    <h2 id="lDown">look down</h2>
                </button>
            </div>
        </div>
    </section>

    <section class="second washHands">
        <div class="row">
            <div class="col11">
                <h1>#5</h1>
            </div>
        </div>
        <div class="row">
            <div class="col11">
                <h2>Wash your hands</h2>
            </div>
        <div class="row">
            <img src="photos/wallDrawings/SVG/hasta.svg" alt=""
                style="transform: rotate(20deg); left:3%; width:18vw; position: absolute;">
        </div>
    </section>

    <section class="focusWall">
        <div class="row" style="position: relative;">

            <div class="col3">
                <img src="/photos/gifs/hoes.gif" alt="" style="width: 150%;">
            </div>
            <div class="col5" style="margin-top: 20%;">
                <p class="wonderWall">even if you "barely touched anything"</p>
                <p class="wonderWall">Wash your hands</p>

                <p class="wonderWall">be a gentleman</p>
            </div>

        </div>
    </section>

    <section class="second" style="margin-top: 10%;">
        <div class="row">
            <div class="col11">
                <h1>Congratulations</h1>
            </div>
        </div>
        <div class="row">
            <div class="col11">
                <h2>You're a real man now!</h2>
            </div>
            <div class="row">
                <div class="col5" style="display:flex; justify-content: center;">

                    <button class="show" style="font-size: 3rem; text-align: center; border: solid black 4px;"
                        onclick="startOver()">Start Over</button>


                </div>
    </section>




    <!-- EYE FINISH -->








    <script type="text/javascript">
        document.addEventListener('mousemove', (e) => {



            const mouseX = e.clientX;
            const mouseY = e.clientY;
            const anchor = document.getElementById('anchor');
            const rekt = anchor.getBoundingClientRect();
            const anchorX = rekt.left + rekt.width / 2;
            const anchorY = rekt.top + rekt.height / 2;

            const angleDeg = angle(mouseX, mouseY, anchorX, anchorY);

            const eyes = document.querySelectorAll('.eye');



            eyes.forEach(eye => {
                eye.style.transform = `rotate(${90 + angleDeg}deg)`;
            })
        })



        function angle(cx, cy, ex, ey) {
            const dy = ey - cy;
            const dx = ex - cx;
            const rad = Math.atan2(dy, dx);
            const deg = rad * 180 / Math.PI;
            return deg;
        }


    </script>




    <script type="text/javascript">
        // ==================== GAME VARIABLES ====================
        let timerExpired = false;
        let deadlineInterval;
        let currentRoundIndex = 0;
        let gameCompleted = false;

        // ==================== SCROLL LOCK ====================
        let scrollLocked = false;
        let lockScrollPosition = 0;
        let eyeCompleted = false;
        let eyeScrollLocked = false;
        let eyeLockScrollPosition = 0;

        function lockScroll() {
            scrollLocked = true;
            lockScrollPosition = window.pageYOffset || document.documentElement.scrollTop;
            console.log('Game locked at position:', lockScrollPosition);
        }

        function unlockScroll() {
            gameCompleted = true;
            scrollLocked = false;
        }

        function lockEyeScroll() {
            eyeScrollLocked = true;
            eyeLockScrollPosition = window.pageYOffset || document.documentElement.scrollTop;
            console.log('Eye locked at position:', eyeLockScrollPosition);
        }

        function unlockEyeScroll() {
            eyeCompleted = true;
            eyeScrollLocked = false;
        }

        // Prevent scrolling down when locked
        function preventScrollDown(e) {
            if ((scrollLocked && !gameCompleted) || (eyeScrollLocked && !eyeCompleted)) {
                const currentScroll = window.pageYOffset || document.documentElement.scrollTop;
                const lockPosition = scrollLocked ? lockScrollPosition : eyeLockScrollPosition;

                // If trying to scroll down past lock position
                if (currentScroll > lockPosition) {
                    e.preventDefault();
                    e.stopPropagation();
                    window.scrollTo(0, lockPosition);
                    return false;
                }
            }
        }

        // Add event listeners for all scroll events
        window.addEventListener('wheel', preventScrollDown, { passive: false });
        window.addEventListener('touchmove', preventScrollDown, { passive: false });
        window.addEventListener('keydown', (e) => {
            if ((scrollLocked && !gameCompleted) || (eyeScrollLocked && !eyeCompleted)) {
                // Prevent arrow down, page down, space, end
                if ([40, 34, 32, 35].includes(e.keyCode)) {
                    e.preventDefault();
                    return false;
                }
            }
        });

        // ==================== GAME ROUNDS ====================
        const round1 = {
            sections: [0, 2, 1, 1, 0],
            correctAnswers: ["urin4"],
            timeLimit: 4
        };

        const round2 = {
            sections: [0, 1, 1, 2, 0],
            correctAnswers: ["urin2"],
            timeLimit: 4
        };

        const round3 = {
            sections: [0, 1, 2, 1, 1],
            correctAnswers: ["urin5"],
            timeLimit: 4
        };

        const round4 = {
            sections: [0, 2, 1, 2, 1],
            correctAnswers: ["urin5"],
            timeLimit: 4
        };

        const round5 = {
            sections: [0, 2, 1, 1, 1],
            correctAnswers: ["urin4", "urin5"],
            timeLimit: 4
        };

        const round6 = {
            sections: [1, 1, 1, 2, 1],
            correctAnswers: ["urin1"],
            timeLimit: 4
        };

        const round7 = {
            sections: [2, 1, 1, 2, 1],
            correctAnswers: ["urin5"],
            timeLimit: 4
        };

        const round8 = {
            sections: [1, 2, 1, 2, 1],
            correctAnswers: ["urin1", "urin5"],
            timeLimit: 4
        };

        const round9 = {
            sections: [2, 2, 1, 1, 2],
            correctAnswers: ["urin4"],
            timeLimit: 4
        };

        const round10 = {
            sections: [2, 1, 2, 2, 1],
            correctAnswers: ["urin5"],
            timeLimit: 4
        };

        const rounds = [round1, round2, round3, round4, round5, round6, round7, round8, round9, round10];

        // ==================== GAME FUNCTIONS ====================
        function startCountdown() {
            const countdownElement = document.getElementById('countdown');
            const messages = ["Ready", "Set", "Go!"];
            let index = 0;

            countdownElement.textContent = messages[index];

            const countdownInterval = setInterval(() => {
                index++;
                if (index < messages.length) {
                    countdownElement.textContent = messages[index];
                } else {
                    clearInterval(countdownInterval);
                    closeGameModal('modalCorrect');
                }
            }, 500);
        }

        function deadlineTimer(timeLimit) {
            let timeLeft = timeLimit;
            timerExpired = false;

            if (deadlineInterval) {
                clearInterval(deadlineInterval);
            }

            deadlineInterval = setInterval(() => {
                timeLeft--;

                if (timeLeft < 0) {
                    clearInterval(deadlineInterval);
                    timerExpired = true;
                    closeGameModal('modalCorrect');
                    document.getElementById('modalWrong').style.display = 'block';
                }
            }, 1000);
        }

        function checkAnswer(sectionId, round) {
            const correctAnswers = round.correctAnswers;

            if (correctAnswers.includes(sectionId)) {
                document.getElementById('modalCorrect').style.display = 'block';
                startCountdown();
                deadlineTimer(round.timeLimit);

                setTimeout(() => {
                    closeGameModal('modalCorrect');
                    currentRoundIndex++;

                    if (currentRoundIndex < rounds.length) {
                        generateSections(rounds[currentRoundIndex]);
                    } else {
                        // Stop the timer and show win modal
                        if (deadlineInterval) {
                            clearInterval(deadlineInterval);
                        }
                      
                        document.getElementById('modalWin').style.display = 'block';
                    }

                    const arrow = document.getElementById('mySvg');
                    arrow.style.animation = 'none';
                    arrow.offsetHeight;
                    arrow.style.clipPath = 'inset(0 0 0 0)';
                    arrow.style.animation = `fadeOutClip ${round.timeLimit - 0.4}s linear forwards`;
                }, 1500);
            } else {
                document.getElementById('modalWrong').style.display = 'block';
            }
        }

        function closeGameModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function generateSections(round) {
            const container = document.querySelector('.containerGame');
            const arrow = document.getElementById('mySvg');

            container.innerHTML = '';

            arrow.style.display = 'block';
            arrow.style.clipPath = 'inset(0 0 0 0)';
            arrow.style.animation = 'none';

            round.sections.forEach((value, index) => {
                // Skip creating sections with value 0 (invisible urinals)
                if (value === 0) return;

                const section = document.createElement('div');
                section.id = `urin${index + 1}`;
                section.className = 'section';

                if (value === 1) {
                    section.innerHTML = `
                        <img src="game/Img/Asset ${index + 1}.svg" alt="Photo ${index + 1}" style="display: block;" class="free">
                        <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: none;">
                    `;
                } else if (value === 2) {
                    section.innerHTML = `
                        <img src="game/Img/Asset ${index + 1}.svg" alt="Photo ${index + 1}" style="display: block;">
                        <img src="game/Img/person1.gif" alt="Occupied" class="occupied" style="display: block;">
                    `;
                    section.style.pointerEvents = 'none';
                }

                container.appendChild(section);
                section.addEventListener('click', () => {
                    checkAnswer(section.id, round);
                });
            });
        }

        function restartGame() {
            currentRoundIndex = 0;
            generateSections(rounds[currentRoundIndex]);
            closeGameModal('modalWrong');
        }

        function giveUpGame() {
            // Clear any running timers
            if (deadlineInterval) {
                clearInterval(deadlineInterval);
            }

            currentRoundIndex = 0; // Reset to first round
            generateSections(rounds[currentRoundIndex]); // Regenerate round 1
            closeGameModal('modalWrong');
            closeGameModal('modalCorrect'); // Also close correct modal if open
            unlockScroll(); // Unlock scrolling so user can continue

            // Scroll down a bit after giving up
            setTimeout(() => {
                const currentScroll = window.pageYOffset;
                window.scrollTo({
                    top: currentScroll + 500,
                    behavior: 'smooth'
                });
            }, 500);
        }

        function playAgain() {
            // Clear any running timers
            if (deadlineInterval) {
                clearInterval(deadlineInterval);
            }

            currentRoundIndex = 0; // Reset to first round
            generateSections(rounds[currentRoundIndex]); // Regenerate round 1
            closeGameModal('modalWin');
        }

        function continueGame() {
            closeGameModal('modalWin');
            unlockScroll(); // Unlock scrolling so user can continue

            // Scroll down a bit after continuing
            setTimeout(() => {
                const currentScroll = window.pageYOffset;
                window.scrollTo({
                    top: currentScroll + 300,
                    behavior: 'smooth'
                });
            }, 500);
        }

        // Disable right-click context menu
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
            return false;
        });

        // Disable dragging on all images and elements
        document.addEventListener('dragstart', (e) => {
            e.preventDefault();
            return false;
        });

        // Force page to start at top on load/refresh
        if (history.scrollRestoration) {
            history.scrollRestoration = 'manual';
        }

        window.addEventListener('beforeunload', () => {
            window.scrollTo(0, 0);
        });

        // Preload all images and videos
        function preloadAssets() {
            const images = Array.from(document.images);
            const videos = Array.from(document.querySelectorAll('video'));
            const loader = document.getElementById('loader');
            const loaderText = document.querySelector('.loader-text');

            let totalAssets = images.length + videos.length;
            let loadedAssets = 0;

            console.log(`Preloading ${totalAssets} assets...`);

            const checkAllLoaded = () => {
                loadedAssets++;
                console.log(`Loaded ${loadedAssets}/${totalAssets} assets`);

                if (loadedAssets >= totalAssets) {
                    console.log('All assets loaded!');

                    // Hide loader and enable scrolling
                    setTimeout(() => {
                        if (loader) loader.style.display = 'none';
                        document.body.classList.remove('loading');

                        // Refresh ScrollTrigger after loader is hidden
                        setTimeout(() => {
                            if (typeof ScrollTrigger !== 'undefined') {
                                ScrollTrigger.refresh();
                                console.log('ScrollTrigger refreshed');
                            }
                        }, 100);
                    }, 500); // Small delay for smooth transition
                }
            };

            // Preload images
            images.forEach(img => {
                if (img.complete) {
                    checkAllLoaded();
                } else {
                    img.addEventListener('load', checkAllLoaded);
                    img.addEventListener('error', checkAllLoaded); // Count errors too
                }
            });

            // Preload videos
            videos.forEach(video => {
                if (video.readyState >= 3) { // HAVE_FUTURE_DATA or higher
                    checkAllLoaded();
                } else {
                    video.addEventListener('loadeddata', checkAllLoaded);
                    video.addEventListener('error', checkAllLoaded); // Count errors too
                }
            });

            // If no assets to load
            if (totalAssets === 0) {
                if (loader) loader.style.display = 'none';
                document.body.classList.remove('loading');
            }
        }

        window.onload = () => {
            generateSections(round1);
            // Make sure page starts at the top
            window.scrollTo(0, 0);
            setTimeout(() => window.scrollTo(0, 0), 0);

            // Start preloading
            preloadAssets();
        };

        // Also force scroll to top immediately
        window.scrollTo(0, 0);

        // Detect when game section reaches top and lock
        window.addEventListener('scroll', () => {
            if (gameCompleted || scrollLocked) return;

            const gameSection = document.querySelector('.game');
            const rect = gameSection.getBoundingClientRect();
            const viewportCenter = window.innerHeight / 2;

            // Lock when game section center aligns with viewport center
            const gameSectionCenter = rect.top + (rect.height / 2);
            if (gameSectionCenter <= viewportCenter && rect.top <= viewportCenter) {
                lockScroll();
            }
        });

        // Detect when eyettes section reaches top and lock
        window.addEventListener('scroll', () => {
            if (eyeCompleted || eyeScrollLocked) return;

            const eyeSection = document.querySelector('.eyettes');
            if (eyeSection) {
                const rect = eyeSection.getBoundingClientRect();

                // Lock when eye section top reaches near the top of viewport (100px from top)
                if (rect.top <= 100) {
                    lockEyeScroll();
                }
            }
        });

        // ==================== VIDEO SCROLLTRIGGER ====================
        const video = document.getElementById("video");

        video.addEventListener('loadedmetadata', () => {
            const videoDuration = video.duration || 1;
            const vidContainer = document.getElementById("vidContainer");
            const rowAbove = document.getElementById("rowAbove");

            const rowAboveHeight = rowAbove.offsetHeight;

            vidContainer.style.height = `${videoDuration * 100 + rowAboveHeight}px`;

            gsap.registerPlugin(ScrollTrigger);

    // Create ScrollTrigger instance
    ScrollTrigger.create({
        trigger: "#video",
        start: "center 35%",
        end: `+=${videoDuration * 100} 80%`, // Scroll duration based on video length (in ms)
        // markers: true,
        pin: true,

        scrub: 0.5, // Smoother scrubbing (reduced from 1)
        onUpdate: (self) => {
            const progress = self.progress; // Get scroll progress (0 to 1)
            const newTime = progress * videoDuration;

            // Only update if there's a meaningful change (reduces jank)
            if (Math.abs(video.currentTime - newTime) > 0.01) {
                video.currentTime = newTime;
            }
        },
        onEnter: () => {
            video.pause(); // Ensure video is paused for scrubbing
        },
        onLeave: () => {
            video.pause(); // Pause the video when leaving
        },
        onEnterBack: () => {
            video.currentTime = 0; // Reset video to the beginning when entering back
            video.pause();
        },
        onLeaveBack: () => {
            video.pause(); // Pause the video when leaving back
        },
    });
});




// end






        // Click function for show the Modal
 console.log("Commit check");
        $(".show").on("click", function () {
            $(".mask").addClass("active");
            resetAutoCloseTimer();
        });

        // Function for close the Modal
        function closeModal() {
            $(".mask").removeClass("active");
        }

        // Call the closeModal function on clicks/keyboard
        $(".close, .mask").on("click", function () {
            closeModal();
        });

        // Automatically close modal after 4 seconds
        var autoCloseTimer;

        function resetAutoCloseTimer() {

            clearTimeout(autoCloseTimer);


            autoCloseTimer = setTimeout(function () {
                closeModal();
            }, 3000);
        }

        // Reset the timer on keyup
        $(document).keyup(function (e) {
            if (e.keyCode == 27) {
                resetAutoCloseTimer();
                closeModal();
            }
        });



        document.addEventListener('DOMContentLoaded', function () {
            // Get all buttons with the class "show"
            var buttons = document.querySelectorAll('.show');
            var lRightClicked = 0;
            var lLeftClicked = 0;
            var lUpClicked = 0;
            var lDownClicked = 0;

            function fadeOutEyettes() {
                var eyettesContainer = document.querySelector('.eyettes');
                if (eyettesContainer) {

                    gsap.to(eyettesContainer, {
                        opacity: 0, duration: 3, onComplete: function () {

                            eyettesContainer.style.display = 'none';
                        }
                    });
                }
            }

            // Attach a click event listener to each button
            buttons.forEach(function (button) {
                button.addEventListener('click', function () {

                    var h2Id = button.querySelector('h2').id;

                    console.log(h2Id);

                    if (h2Id === 'lRight') {

                        var modalParagraph = document.querySelector('.modal p');
                        if (modalParagraph) {
                            modalParagraph.textContent = "That's not a good place to do that...";
                            lRightClicked++;
                            button.style.color = 'grey';

                        }
                    }
                    if (h2Id === 'lLeft') {

                        var modalParagraph = document.querySelector('.modal p');
                        if (modalParagraph) {
                            modalParagraph.textContent = "what's wrong with you?";
                            lLeftClicked++;
                            button.style.color = 'grey';
                        }
                    }
                    if (h2Id === 'lUp') {

                        var modalParagraph = document.querySelector('.modal p');
                        if (modalParagraph) {
                            modalParagraph.textContent = "who pees like that??";
                            lUpClicked++;
                            button.style.color = 'grey';
                        }
                    }
                    if (h2Id === 'lDown') {

                        var modalParagraph = document.querySelector('.modal p');
                        if (modalParagraph) {
                            modalParagraph.textContent = "What are you so stressed about? are you new to having a penis?";
                            lDownClicked++;
                            button.style.color = 'grey';
                        }
                    }
                    if (lRightClicked >= 1 && lUpClicked >= 1 && lDownClicked >= 1 && lLeftClicked >= 1) {
                        console.log('All buttons clicked at least once!');
                        document.getElementById('wall').style.display = 'block';


                    }
                    var lookStraightButton = document.getElementById('wall');
                    var lookStraightButton = document.getElementById('wall');
                    var modalParagraph = document.querySelector('.modal p');
                    var mask = document.querySelector('.mask');

                    if (lookStraightButton && modalParagraph && mask) {
                        lookStraightButton.addEventListener('click', function () {

                            lookStraightButton.style.display = 'none';


                            lookStraightButton.style.color = '';


                            modalParagraph.textContent = "Focus REALLY REALLY hard on the wall";


                            mask.style.display = 'block';
                            mask.style.visibility = 'visible';


                            setTimeout(function () {

                                modalParagraph.textContent = "you've just peed. Congratulations.";

                                setTimeout(function () {
                                    // Unlock eye scroll BEFORE hiding modal
                                    unlockEyeScroll();

                                    // Remove inline styles to allow CSS classes to work again
                                    mask.style.display = '';
                                    mask.style.visibility = '';

                                    // Reset eye buttons
                                    lRightClicked = 0;
                                    lLeftClicked = 0;
                                    lUpClicked = 0;
                                    lDownClicked = 0;

                                    // Reset button colors back to original
                                    buttons.forEach(function(btn) {
                                        btn.style.color = '';
                                    });

                                    // Hide "Look straight" button again
                                    lookStraightButton.style.display = 'none';

                                    // Scroll down a bit after unlocking
                                    setTimeout(() => {
                                        const currentScroll = window.pageYOffset;
                                        window.scrollTo({
                                            top: currentScroll + 300,
                                            behavior: 'smooth'
                                        });
                                    }, 500);
                                }, 1500);
                            }, 2000);
                        });
                    }

                });


            });



        });

        // Function to control fading in and out of paragraphs

        document.addEventListener('DOMContentLoaded', function () {
            const wonderWallSentences = document.querySelectorAll('.wonderWall');
            let currentIndex = 0;

            const fadeInAndOut = (index) => {
                const currentSentence = wonderWallSentences[index];

                // Make all sentences invisible
                wonderWallSentences.forEach(sentence => {
                    sentence.style.opacity = 0;
                });

                // Fade in the current sentence
                gsap.to(currentSentence, {
                    opacity: 1, duration: 0.7, onComplete: () => {
                        // Wait for 2 seconds and then fade out
                        setTimeout(() => {
                            gsap.to(currentSentence, {
                                opacity: 0, duration: 0.7, onComplete: () => {
                                    // Move to the next sentence
                                    currentIndex = (currentIndex + 1) % wonderWallSentences.length;
                                    fadeInAndOut(currentIndex);
                                }
                            });
                        }, 2000); // 2 seconds
                    }
                });
            };


            fadeInAndOut(currentIndex);
        });

        // Reload the page from the top
        function startOver() {

            window.location.href = window.location.origin + window.location.pathname + window.location.search;
        }

    </script>

</html>